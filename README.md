# ILI9488-on-Raspberry-Pi-Zero-2W
How to use an ILI9488 SPI display on a Raspberry Pi Zero 2W.

ATTENTION! This procedure only works correctly on 32-bit systems! Unfortunately, I have not yet found a solution to use this display on a 64-bit system!
If anyone has the solution, I would be happy if they would also provide us with the 64-bit solution.

First, we need to make the hardware connections between the ILI9488 display and the Raspberry Pi Zero 2W.

I used these hardware connections:

<img width="357" alt="pi2ILI9488displayPinout" src="https://github.com/user-attachments/assets/39603568-4b69-46e7-b80c-c274a247b4b1" />

After making the hardware connections, after the first boot, I did this.

Edit the file /boot/config.txt  (If you are using Raspbian with the Desktop interface, edit the file /boot/firmware/config.txt)

```sudo nano /boot/config.txt```

And if you find the line:

```dtparam=spi=on```

put a # in front of that line so that the line looks like this:

```#dtparam=spi=on```

Next is the installation of the FBCP driver and its configuration for the ILI9488 display.

```cd ~```

```sudo apt update```

```sudo apt install libraspberrypi-dev```

![ili9488_1](https://github.com/user-attachments/assets/2b716828-2851-4461-95ee-59c81c6ac153)


```sudo apt install cmake git build-essential```

![Screenshot 2025-05-31 161133](https://github.com/user-attachments/assets/67ce19e5-9401-4a10-bf79-1f7abb946949)

Then clone and build the project:

```git clone https://github.com/juj/fbcp-ili9341.git```

![Screenshot 2025-05-31 161443](https://github.com/user-attachments/assets/5e03731f-6c42-4fc9-a58b-bbdeb36b4312)

Enters the fbcp-ili9341 source folder.

```cd fbcp-ili9341```

Creates a new directory named build.

```mkdir build```

Changes the working directory to the build folder you just created.
This is where the compilation will happen.

```cd build```

Configures the build system using CMake, with specific settings tailored to your hardware.

```cmake -DILI9488=ON -DGPIO_TFT_DATA_CONTROL=24 -DGPIO_TFT_RESET_PIN=25 -DSPI_BUS_CLOCK_DIVISOR=8 -DSTATISTICS=0  ..```

Explanation of options:

Option	Meaning
-DILI9488=ON	Enables support for the ILI9488 display (default is ILI9341).
-DGPIO_TFT_DATA_CONTROL=24	Uses GPIO 24 as the DC (Data/Command) pin for SPI communication.
-DGPIO_TFT_RESET_PIN=25	Uses GPIO 25 as the Reset pin for the display.
-DSPI_BUS_CLOCK_DIVISOR=8	Sets SPI clock divisor (base 400 MHz ÷ 8 = 50 MHz SPI speed).
-DSTATISTICS=0	Disables printing performance stats to the console.
..	Refers to the parent directory containing the source code.


Builds (compiles) the software using the make system generated by CMake.

```make -j```

![Screenshot 2025-05-31 162246](https://github.com/user-attachments/assets/72723046-5a78-40a5-b731-5e7866f434bc)

At this point we have compiled the FBCP driver for the ILI9488 SPI display.

To automatically start the driver at boot, we edit the file:

```sudo nano /etc/rc.local```

where before the final line:

```exit 0```

we add the line:

```/home/USER/fbcp-ili9341/build/fbcp-ili9341 &```

So the end of the file will look like this:

```/home/USER/fbcp-ili9341/build/fbcp-ili9341 &```
```exit 0```

ATTENTION! On every command line where you encounter USER, it will need to be replaced with your username!

If you are using moOde Audio Player, 
you will need to delay the driver startup so that the moOde graphical interface is already active and only then start the driver.
In this case, you will not do the automatic startup from the /etc/rc.local file!


If you want to use the display for moOde Audio, you will first need to activate it from the moOde Audio web interface at
CONFIGURATION -> SYSTEM-> Peripherals
Display -> ON
Wake on play -> ON

![Screenshot 2025-05-31 171235](https://github.com/user-attachments/assets/107669fa-f7a7-4bec-9661-951e6a766ba3)


Create a script named:

```sudo nano /home/USER/start_fbcp.sh```

which should have the following content:
```
#!/bin/bash
echo "$(date): Script start" >> /home/USER/fbcp.log
sleep 40
echo "$(date): Sleep ended, starting fbcp-ili9341" >> /home/USER/fbcp.log

exec /home/USER/fbcp-ili9341/build/fbcp-ili9341 --fbdev /dev/fb0 --display-rotation=270
```

This will cause the graphics driver to start 40 seconds after boot, enough time for moOde Audio to start the graphical interface.

Make sure the script is executable:

```chmod +x /home/USER/start_fbcp.sh```

Create the file:

```sudo nano /etc/systemd/system/fbcp-ili9341.service```

after that:

```
sudo systemctl daemon-reload
sudo systemctl enable fbcp-ili9341.service
sudo systemctl restart fbcp-ili9341.service
```

Status check:

```sudo systemctl status fbcp-ili9341.service```

Check the created log:

```cat /home/USER/fbcp.log```

Final test:

``sudo reboot``

I found this procedure on the page: https://bytesnbits.co.uk/retropie-raspberry-pi-0-spi-lcd/
which helped me a lot to solve this challenge.
Thanks to the author for the documentation he made available to us!
